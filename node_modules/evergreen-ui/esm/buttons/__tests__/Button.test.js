import _extends from "@babel/runtime/helpers/esm/extends";
import React from 'react';
import { render } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import renderer from 'react-test-renderer';
import { LockIcon } from '../../icons/generated/LockIcon';
import { ThemeProvider } from '../../theme';
import { classicTheme, defaultTheme } from '../../themes';
import Button from '../src/Button';
import IconButton from '../src/IconButton';
describe.each([['default', defaultTheme], ['classic', classicTheme]])('<Button /> % %s', function (_, theme) {
  it('snapshots with the rendered output', function () {
    var component = /*#__PURE__*/React.createElement(ThemeProvider, {
      value: theme
    }, /*#__PURE__*/React.createElement(Button, null));
    var tree = renderer.create(component).toJSON();
    expect(tree).toMatchSnapshot();
  });
});

function makeButtonFixture() {
  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  return /*#__PURE__*/React.createElement(Button, _extends({
    "data-testid": "button"
  }, props), "Test");
}

makeButtonFixture.displayName = "makeButtonFixture";

function makeIconButtonFixture() {
  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  return /*#__PURE__*/React.createElement(IconButton, _extends({
    "data-testid": "button"
  }, props));
}

makeIconButtonFixture.displayName = "makeIconButtonFixture";
describe('Button', function () {
  it('renders children without crashing', function () {
    expect(function () {
      return render(makeButtonFixture());
    }).not.toThrow();
  });
  it('accepts an `onClick` handler that gets called upon clicking', function () {
    var onClick = jest.fn();

    var _render = render(makeButtonFixture({
      onClick: onClick
    })),
        getByTestId = _render.getByTestId;

    var container = getByTestId('button');
    userEvent.click(container);
    expect(onClick).toHaveBeenCalledTimes(1);
  });
  it('has a `disabled` prop that disables the button', function () {
    var onClick = jest.fn();

    var _render2 = render(makeButtonFixture({
      onClick: onClick,
      disabled: true
    })),
        getByTestId = _render2.getByTestId;

    var container = getByTestId('button');
    expect(function () {
      return userEvent.click(container);
    }).toThrowError();
    expect(onClick).toHaveBeenCalledTimes(0);
  });
  it('has a `isLoading` prop that renders a spinner and disables the button', function () {
    var onClick = jest.fn();

    var _render3 = render(makeButtonFixture({
      onClick: onClick,
      isLoading: true
    })),
        getByTestId = _render3.getByTestId;

    var container = getByTestId('button');
    expect(function () {
      return userEvent.click(container);
    }).toThrowError();
    expect(container.querySelector('svg')).toBeVisible();
    expect(onClick).toHaveBeenCalledTimes(0);
  });
  it('renders an icon in either the `iconBefore` props', function () {
    var _render4 = render(makeButtonFixture({
      iconBefore: LockIcon
    })),
        getByTestId = _render4.getByTestId;

    var container = getByTestId('button');
    expect(container.querySelector('svg')).toHaveAttribute('data-icon', 'lock');
  });
  it('renders an icon in either the `iconAfter` props', function () {
    var _render5 = render(makeButtonFixture({
      iconAfter: LockIcon
    })),
        getByTestId = _render5.getByTestId;

    var container = getByTestId('button');
    expect(container.querySelector('svg')).toHaveAttribute('data-icon', 'lock');
  });
  it('properly handles keyboard events to simulate clicks', function () {
    var onClick = jest.fn();

    var _render6 = render(makeButtonFixture({
      onClick: onClick,
      iconAfter: LockIcon
    })),
        getByTestId = _render6.getByTestId;

    var container = getByTestId('button');
    container.focus();
    expect(document.activeElement).toEqual(container);
    userEvent.keyboard('{enter}');
    expect(onClick).toHaveBeenCalledTimes(1);
    userEvent.keyboard('{space}');
    expect(onClick).toHaveBeenCalledTimes(2);
  });
});
describe('IconButton', function () {
  it('Passes through an icon when passes as a component reference', function () {
    var _render7 = render(makeIconButtonFixture({
      icon: LockIcon
    })),
        getByTestId = _render7.getByTestId;

    var container = getByTestId('button');
    expect(container.querySelector('svg')).toHaveAttribute('data-icon', 'lock');
  });
  it('Passes through an instantiated component as `icon`', function () {
    var _render8 = render(makeIconButtonFixture({
      icon: /*#__PURE__*/React.createElement(LockIcon, {
        size: 24
      })
    })),
        getByTestId = _render8.getByTestId;

    var container = getByTestId('button');
    var svg = container.querySelector('svg');
    expect(window.getComputedStyle(svg).width).toEqual('24px');
    expect(window.getComputedStyle(svg).height).toEqual('24px');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9idXR0b25zL19fdGVzdHNfXy9CdXR0b24udGVzdC5qcyJdLCJuYW1lcyI6WyJSZWFjdCIsInJlbmRlciIsInVzZXJFdmVudCIsInJlbmRlcmVyIiwiTG9ja0ljb24iLCJUaGVtZVByb3ZpZGVyIiwiY2xhc3NpY1RoZW1lIiwiZGVmYXVsdFRoZW1lIiwiQnV0dG9uIiwiSWNvbkJ1dHRvbiIsImRlc2NyaWJlIiwiZWFjaCIsIl8iLCJ0aGVtZSIsIml0IiwiY29tcG9uZW50IiwidHJlZSIsImNyZWF0ZSIsInRvSlNPTiIsImV4cGVjdCIsInRvTWF0Y2hTbmFwc2hvdCIsIm1ha2VCdXR0b25GaXh0dXJlIiwicHJvcHMiLCJtYWtlSWNvbkJ1dHRvbkZpeHR1cmUiLCJub3QiLCJ0b1Rocm93Iiwib25DbGljayIsImplc3QiLCJmbiIsImdldEJ5VGVzdElkIiwiY29udGFpbmVyIiwiY2xpY2siLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiLCJkaXNhYmxlZCIsInRvVGhyb3dFcnJvciIsImlzTG9hZGluZyIsInF1ZXJ5U2VsZWN0b3IiLCJ0b0JlVmlzaWJsZSIsImljb25CZWZvcmUiLCJ0b0hhdmVBdHRyaWJ1dGUiLCJpY29uQWZ0ZXIiLCJmb2N1cyIsImRvY3VtZW50IiwiYWN0aXZlRWxlbWVudCIsInRvRXF1YWwiLCJrZXlib2FyZCIsImljb24iLCJzdmciLCJ3aW5kb3ciLCJnZXRDb21wdXRlZFN0eWxlIiwid2lkdGgiLCJoZWlnaHQiXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPQSxLQUFQLE1BQWtCLE9BQWxCO0FBQ0EsU0FBU0MsTUFBVCxRQUF1Qix3QkFBdkI7QUFDQSxPQUFPQyxTQUFQLE1BQXNCLDZCQUF0QjtBQUNBLE9BQU9DLFFBQVAsTUFBcUIscUJBQXJCO0FBQ0EsU0FBU0MsUUFBVCxRQUF5QixnQ0FBekI7QUFDQSxTQUFTQyxhQUFULFFBQThCLGFBQTlCO0FBQ0EsU0FBU0MsWUFBVCxFQUF1QkMsWUFBdkIsUUFBMkMsY0FBM0M7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QUFReUIsV0FBUixZQUFRQSxXQUFSOztBQUNBLFFBQU1DLFNBQVMsR0FBR0QsV0FBVyxDQUFDLFFBQUQsQ0FBN0I7QUFDQVYsSUFBQUEsTUFBTSxDQUFDVyxTQUFTLENBQUNNLGFBQVYsQ0FBd0IsS0FBeEIsQ0FBRCxDQUFOLENBQXVDRyxlQUF2QyxDQUF1RCxXQUF2RCxFQUFvRSxNQUFwRTtBQUNELEdBSkMsQ0FBRjtBQUtBekIsRUFBQUEsRUFBRSxDQUFDLG9EQUFELEVBQXVELFlBQU07QUFDN0QsbUJBQXdCYixNQUFNLENBQUNzQixxQkFBcUIsQ0FBQztBQUFFdUIsTUFBQUEsSUFBSSxlQUFFLG9CQUFDLFFBQUQ7QUFBVSxRQUFBLElBQUksRUFBRTtBQUFoQjtBQUFSLEtBQUQsQ0FBdEIsQ0FBOUI7QUFBQSxRQUFRakIsV0FBUixZQUFRQSxXQUFSOztBQUNBLFFBQU1DLFNBQVMsR0FBR0QsV0FBVyxDQUFDLFFBQUQsQ0FBN0I7QUFDQSxRQUFNa0IsR0FBRyxHQUFHakIsU0FBUyxDQUFDTSxhQUFWLENBQXdCLEtBQXhCLENBQVo7QUFDQWpCLElBQUFBLE1BQU0sQ0FBQzZCLE1BQU0sQ0FBQ0MsZ0JBQVAsQ0FBd0JGLEdBQXhCLEVBQTZCRyxLQUE5QixDQUFOLENBQTJDTixPQUEzQyxDQUFtRCxNQUFuRDtBQUNBekIsSUFBQUEsTUFBTSxDQUFDNkIsTUFBTSxDQUFDQyxnQkFBUCxDQUF3QkYsR0FBeEIsRUFBNkJJLE1BQTlCLENBQU4sQ0FBNENQLE9BQTVDLENBQW9ELE1BQXBEO0FBQ0QsR0FOQyxDQUFGO0FBT0QsQ0FiTyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgcmVuZGVyIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCdcbmltcG9ydCB1c2VyRXZlbnQgZnJvbSAnQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50J1xuaW1wb3J0IHJlbmRlcmVyIGZyb20gJ3JlYWN0LXRlc3QtcmVuZGVyZXInXG5pbXBvcnQgeyBMb2NrSWNvbiB9IGZyb20gJy4uLy4uL2ljb25zL2dlbmVyYXRlZC9Mb2NrSWNvbidcbmltcG9ydCB7IFRoZW1lUHJvdmlkZXIgfSBmcm9tICcuLi8uLi90aGVtZSdcbmltcG9ydCB7IGNsYXNzaWNUaGVtZSwgZGVmYXVsdFRoZW1lIH0gZnJvbSAnLi4vLi4vdGhlbWVzJ1xuaW1wb3J0IEJ1dHRvbiBmcm9tICcuLi9zcmMvQnV0dG9uJ1xuaW1wb3J0IEljb25CdXR0b24gZnJvbSAnLi4vc3JjL0ljb25CdXR0b24nXG5cbmRlc2NyaWJlLmVhY2goW1xuICBbJ2RlZmF1bHQnLCBkZWZhdWx0VGhlbWVdLFxuICBbJ2NsYXNzaWMnLCBjbGFzc2ljVGhlbWVdXG5dKSgnPEJ1dHRvbiAvPiAlICVzJywgKF8sIHRoZW1lKSA9PiB7XG4gIGl0KCdzbmFwc2hvdHMgd2l0aCB0aGUgcmVuZGVyZWQgb3V0cHV0JywgKCkgPT4ge1xuICAgIGNvbnN0IGNvbXBvbmVudCA9IChcbiAgICAgIDxUaGVtZVByb3ZpZGVyIHZhbHVlPXt0aGVtZX0+XG4gICAgICAgIDxCdXR0b24gLz5cbiAgICAgIDwvVGhlbWVQcm92aWRlcj5cbiAgICApXG4gICAgY29uc3QgdHJlZSA9IHJlbmRlcmVyLmNyZWF0ZShjb21wb25lbnQpLnRvSlNPTigpXG4gICAgZXhwZWN0KHRyZWUpLnRvTWF0Y2hTbmFwc2hvdCgpXG4gIH0pXG59KVxuXG5mdW5jdGlvbiBtYWtlQnV0dG9uRml4dHVyZShwcm9wcyA9IHt9KSB7XG4gIHJldHVybiAoXG4gICAgPEJ1dHRvbiBkYXRhLXRlc3RpZD1cImJ1dHRvblwiIHsuLi5wcm9wc30+XG4gICAgICBUZXN0XG4gICAgPC9CdXR0b24+XG4gIClcbn1cblxuZnVuY3Rpb24gbWFrZUljb25CdXR0b25GaXh0dXJlKHByb3BzID0ge30pIHtcbiAgcmV0dXJuIDxJY29uQnV0dG9uIGRhdGEtdGVzdGlkPVwiYnV0dG9uXCIgey4uLnByb3BzfSAvPlxufVxuXG5kZXNjcmliZSgnQnV0dG9uJywgKCkgPT4ge1xuICBpdCgncmVuZGVycyBjaGlsZHJlbiB3aXRob3V0IGNyYXNoaW5nJywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiByZW5kZXIobWFrZUJ1dHRvbkZpeHR1cmUoKSkpLm5vdC50b1Rocm93KClcbiAgfSlcbiAgaXQoJ2FjY2VwdHMgYW4gYG9uQ2xpY2tgIGhhbmRsZXIgdGhhdCBnZXRzIGNhbGxlZCB1cG9uIGNsaWNraW5nJywgKCkgPT4ge1xuICAgIGNvbnN0IG9uQ2xpY2sgPSBqZXN0LmZuKClcbiAgICBjb25zdCB7IGdldEJ5VGVzdElkIH0gPSByZW5kZXIobWFrZUJ1dHRvbkZpeHR1cmUoeyBvbkNsaWNrIH0pKVxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGdldEJ5VGVzdElkKCdidXR0b24nKVxuXG4gICAgdXNlckV2ZW50LmNsaWNrKGNvbnRhaW5lcilcbiAgICBleHBlY3Qob25DbGljaykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpXG4gIH0pXG4gIGl0KCdoYXMgYSBgZGlzYWJsZWRgIHByb3AgdGhhdCBkaXNhYmxlcyB0aGUgYnV0dG9uJywgKCkgPT4ge1xuICAgIGNvbnN0IG9uQ2xpY2sgPSBqZXN0LmZuKClcbiAgICBjb25zdCB7IGdldEJ5VGVzdElkIH0gPSByZW5kZXIobWFrZUJ1dHRvbkZpeHR1cmUoeyBvbkNsaWNrLCBkaXNhYmxlZDogdHJ1ZSB9KSlcbiAgICBjb25zdCBjb250YWluZXIgPSBnZXRCeVRlc3RJZCgnYnV0dG9uJylcblxuICAgIGV4cGVjdCgoKSA9PiB1c2VyRXZlbnQuY2xpY2soY29udGFpbmVyKSkudG9UaHJvd0Vycm9yKClcbiAgICBleHBlY3Qob25DbGljaykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDApXG4gIH0pXG4gIGl0KCdoYXMgYSBgaXNMb2FkaW5nYCBwcm9wIHRoYXQgcmVuZGVycyBhIHNwaW5uZXIgYW5kIGRpc2FibGVzIHRoZSBidXR0b24nLCAoKSA9PiB7XG4gICAgY29uc3Qgb25DbGljayA9IGplc3QuZm4oKVxuICAgIGNvbnN0IHsgZ2V0QnlUZXN0SWQgfSA9IHJlbmRlcihtYWtlQnV0dG9uRml4dHVyZSh7IG9uQ2xpY2ssIGlzTG9hZGluZzogdHJ1ZSB9KSlcbiAgICBjb25zdCBjb250YWluZXIgPSBnZXRCeVRlc3RJZCgnYnV0dG9uJylcblxuICAgIGV4cGVjdCgoKSA9PiB1c2VyRXZlbnQuY2xpY2soY29udGFpbmVyKSkudG9UaHJvd0Vycm9yKClcbiAgICBleHBlY3QoY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpKS50b0JlVmlzaWJsZSgpXG4gICAgZXhwZWN0KG9uQ2xpY2spLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKVxuICB9KVxuICBpdCgncmVuZGVycyBhbiBpY29uIGluIGVpdGhlciB0aGUgYGljb25CZWZvcmVgIHByb3BzJywgKCkgPT4ge1xuICAgIGNvbnN0IHsgZ2V0QnlUZXN0SWQgfSA9IHJlbmRlcihtYWtlQnV0dG9uRml4dHVyZSh7IGljb25CZWZvcmU6IExvY2tJY29uIH0pKVxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGdldEJ5VGVzdElkKCdidXR0b24nKVxuXG4gICAgZXhwZWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzdmcnKSkudG9IYXZlQXR0cmlidXRlKCdkYXRhLWljb24nLCAnbG9jaycpXG4gIH0pXG4gIGl0KCdyZW5kZXJzIGFuIGljb24gaW4gZWl0aGVyIHRoZSBgaWNvbkFmdGVyYCBwcm9wcycsICgpID0+IHtcbiAgICBjb25zdCB7IGdldEJ5VGVzdElkIH0gPSByZW5kZXIobWFrZUJ1dHRvbkZpeHR1cmUoeyBpY29uQWZ0ZXI6IExvY2tJY29uIH0pKVxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGdldEJ5VGVzdElkKCdidXR0b24nKVxuXG4gICAgZXhwZWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzdmcnKSkudG9IYXZlQXR0cmlidXRlKCdkYXRhLWljb24nLCAnbG9jaycpXG4gIH0pXG4gIGl0KCdwcm9wZXJseSBoYW5kbGVzIGtleWJvYXJkIGV2ZW50cyB0byBzaW11bGF0ZSBjbGlja3MnLCAoKSA9PiB7XG4gICAgY29uc3Qgb25DbGljayA9IGplc3QuZm4oKVxuICAgIGNvbnN0IHsgZ2V0QnlUZXN0SWQgfSA9IHJlbmRlcihtYWtlQnV0dG9uRml4dHVyZSh7IG9uQ2xpY2ssIGljb25BZnRlcjogTG9ja0ljb24gfSkpXG4gICAgY29uc3QgY29udGFpbmVyID0gZ2V0QnlUZXN0SWQoJ2J1dHRvbicpXG5cbiAgICBjb250YWluZXIuZm9jdXMoKVxuICAgIGV4cGVjdChkb2N1bWVudC5hY3RpdmVFbGVtZW50KS50b0VxdWFsKGNvbnRhaW5lcilcbiAgICB1c2VyRXZlbnQua2V5Ym9hcmQoJ3tlbnRlcn0nKVxuICAgIGV4cGVjdChvbkNsaWNrKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSlcbiAgICB1c2VyRXZlbnQua2V5Ym9hcmQoJ3tzcGFjZX0nKVxuICAgIGV4cGVjdChvbkNsaWNrKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMilcbiAgfSlcbn0pXG5cbmRlc2NyaWJlKCdJY29uQnV0dG9uJywgKCkgPT4ge1xuICBpdCgnUGFzc2VzIHRocm91Z2ggYW4gaWNvbiB3aGVuIHBhc3NlcyBhcyBhIGNvbXBvbmVudCByZWZlcmVuY2UnLCAoKSA9PiB7XG4gICAgY29uc3QgeyBnZXRCeVRlc3RJZCB9ID0gcmVuZGVyKG1ha2VJY29uQnV0dG9uRml4dHVyZSh7IGljb246IExvY2tJY29uIH0pKVxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGdldEJ5VGVzdElkKCdidXR0b24nKVxuICAgIGV4cGVjdChjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3ZnJykpLnRvSGF2ZUF0dHJpYnV0ZSgnZGF0YS1pY29uJywgJ2xvY2snKVxuICB9KVxuICBpdCgnUGFzc2VzIHRocm91Z2ggYW4gaW5zdGFudGlhdGVkIGNvbXBvbmVudCBhcyBgaWNvbmAnLCAoKSA9PiB7XG4gICAgY29uc3QgeyBnZXRCeVRlc3RJZCB9ID0gcmVuZGVyKG1ha2VJY29uQnV0dG9uRml4dHVyZSh7IGljb246IDxMb2NrSWNvbiBzaXplPXsyNH0gLz4gfSkpXG4gICAgY29uc3QgY29udGFpbmVyID0gZ2V0QnlUZXN0SWQoJ2J1dHRvbicpXG4gICAgY29uc3Qgc3ZnID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpXG4gICAgZXhwZWN0KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHN2Zykud2lkdGgpLnRvRXF1YWwoJzI0cHgnKVxuICAgIGV4cGVjdCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShzdmcpLmhlaWdodCkudG9FcXVhbCgnMjRweCcpXG4gIH0pXG59KVxuIl19