"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _react = _interopRequireDefault(require("react"));

var _react2 = require("@testing-library/react");

var _userEvent = _interopRequireDefault(require("@testing-library/user-event"));

var _reactTestRenderer = _interopRequireDefault(require("react-test-renderer"));

var _LockIcon = require("../../icons/generated/LockIcon");

var _theme = require("../../theme");

var _themes = require("../../themes");

var _Button = _interopRequireDefault(require("../src/Button"));

var _IconButton = _interopRequireDefault(require("../src/IconButton"));

describe.each([['default', _themes.defaultTheme], ['classic', _themes.classicTheme]])('<Button /> % %s', function (_, theme) {
  it('snapshots with the rendered output', function () {
    var component = /*#__PURE__*/_react["default"].createElement(_theme.ThemeProvider, {
      value: theme
    }, /*#__PURE__*/_react["default"].createElement(_Button["default"], null));

    var tree = _reactTestRenderer["default"].create(component).toJSON();

    expect(tree).toMatchSnapshot();
  });
});

function makeButtonFixture() {
  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  return /*#__PURE__*/_react["default"].createElement(_Button["default"], (0, _extends2["default"])({
    "data-testid": "button"
  }, props), "Test");
}

makeButtonFixture.displayName = "makeButtonFixture";

function makeIconButtonFixture() {
  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  return /*#__PURE__*/_react["default"].createElement(_IconButton["default"], (0, _extends2["default"])({
    "data-testid": "button"
  }, props));
}

makeIconButtonFixture.displayName = "makeIconButtonFixture";
describe('Button', function () {
  it('renders children without crashing', function () {
    expect(function () {
      return (0, _react2.render)(makeButtonFixture());
    }).not.toThrow();
  });
  it('accepts an `onClick` handler that gets called upon clicking', function () {
    var onClick = jest.fn();

    var _render = (0, _react2.render)(makeButtonFixture({
      onClick: onClick
    })),
        getByTestId = _render.getByTestId;

    var container = getByTestId('button');

    _userEvent["default"].click(container);

    expect(onClick).toHaveBeenCalledTimes(1);
  });
  it('has a `disabled` prop that disables the button', function () {
    var onClick = jest.fn();

    var _render2 = (0, _react2.render)(makeButtonFixture({
      onClick: onClick,
      disabled: true
    })),
        getByTestId = _render2.getByTestId;

    var container = getByTestId('button');
    expect(function () {
      return _userEvent["default"].click(container);
    }).toThrowError();
    expect(onClick).toHaveBeenCalledTimes(0);
  });
  it('has a `isLoading` prop that renders a spinner and disables the button', function () {
    var onClick = jest.fn();

    var _render3 = (0, _react2.render)(makeButtonFixture({
      onClick: onClick,
      isLoading: true
    })),
        getByTestId = _render3.getByTestId;

    var container = getByTestId('button');
    expect(function () {
      return _userEvent["default"].click(container);
    }).toThrowError();
    expect(container.querySelector('svg')).toBeVisible();
    expect(onClick).toHaveBeenCalledTimes(0);
  });
  it('renders an icon in either the `iconBefore` props', function () {
    var _render4 = (0, _react2.render)(makeButtonFixture({
      iconBefore: _LockIcon.LockIcon
    })),
        getByTestId = _render4.getByTestId;

    var container = getByTestId('button');
    expect(container.querySelector('svg')).toHaveAttribute('data-icon', 'lock');
  });
  it('renders an icon in either the `iconAfter` props', function () {
    var _render5 = (0, _react2.render)(makeButtonFixture({
      iconAfter: _LockIcon.LockIcon
    })),
        getByTestId = _render5.getByTestId;

    var container = getByTestId('button');
    expect(container.querySelector('svg')).toHaveAttribute('data-icon', 'lock');
  });
  it('properly handles keyboard events to simulate clicks', function () {
    var onClick = jest.fn();

    var _render6 = (0, _react2.render)(makeButtonFixture({
      onClick: onClick,
      iconAfter: _LockIcon.LockIcon
    })),
        getByTestId = _render6.getByTestId;

    var container = getByTestId('button');
    container.focus();
    expect(document.activeElement).toEqual(container);

    _userEvent["default"].keyboard('{enter}');

    expect(onClick).toHaveBeenCalledTimes(1);

    _userEvent["default"].keyboard('{space}');

    expect(onClick).toHaveBeenCalledTimes(2);
  });
});
describe('IconButton', function () {
  it('Passes through an icon when passes as a component reference', function () {
    var _render7 = (0, _react2.render)(makeIconButtonFixture({
      icon: _LockIcon.LockIcon
    })),
        getByTestId = _render7.getByTestId;

    var container = getByTestId('button');
    expect(container.querySelector('svg')).toHaveAttribute('data-icon', 'lock');
  });
  it('Passes through an instantiated component as `icon`', function () {
    var _render8 = (0, _react2.render)(makeIconButtonFixture({
      icon: /*#__PURE__*/_react["default"].createElement(_LockIcon.LockIcon, {
        size: 24
      })
    })),
        getByTestId = _render8.getByTestId;

    var container = getByTestId('button');
    var svg = container.querySelector('svg');
    expect(window.getComputedStyle(svg).width).toEqual('24px');
    expect(window.getComputedStyle(svg).height).toEqual('24px');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9idXR0b25zL19fdGVzdHNfXy9CdXR0b24udGVzdC5qcyJdLCJuYW1lcyI6WyJkZXNjcmliZSIsImVhY2giLCJkZWZhdWx0VGhlbWUiLCJjbGFzc2ljVGhlbWUiLCJfIiwidGhlbWUiLCJpdCIsImNvbXBvbmVudCIsInRyZWUiLCJyZW5kZXJlciIsImNyZWF0ZSIsInRvSlNPTiIsImV4cGVjdCIsInRvTWF0Y2hTbmFwc2hvdCIsIm1ha2VCdXR0b25GaXh0dXJlIiwicHJvcHMiLCJtYWtlSWNvbkJ1dHRvbkZpeHR1cmUiLCJub3QiLCJ0b1Rocm93Iiwib25DbGljayIsImplc3QiLCJmbiIsImdldEJ5VGVzdElkIiwiY29udGFpbmVyIiwidXNlckV2ZW50IiwiY2xpY2siLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiLCJkaXNhYmxlZCIsInRvVGhyb3dFcnJvciIsImlzTG9hZGluZyIsInF1ZXJ5U2VsZWN0b3IiLCJ0b0JlVmlzaWJsZSIsImljb25CZWZvcmUiLCJMb2NrSWNvbiIsInRvSGF2ZUF0dHJpYnV0ZSIsImljb25BZnRlciIsImZvY3VzIiwiZG9jdW1lbnQiLCJhY3RpdmVFbGVtZW50IiwidG9FcXVhbCIsImtleWJvYXJkIiwiaWNvbiIsInN2ZyIsIndpbmRvdyIsImdldENvbXB1dGVkU3R5bGUiLCJ3aWR0aCIsImhlaWdodCJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUFBLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjLENBQ1osQ0FBQyxTQUFELEVBQVlDLG9CQUFaLENBRFksRUFFWixDQUFDLFNBQUQsRUFBWUMsb0JBQVosQ0FGWSxDQUFkLEVBR0csaUJBSEgsRUFHc0IsVUFBQ0MsQ0FBRCxFQUFJQyxLQUFKLEVBQWM7QUFDbENDLEVBQUFBLEVBQUUsQ0FBQyxvQ0FBRCxFQUF1QyxZQUFNO0FBQzdDLFFBQU1DLFNBQVMsZ0JBQ2IsZ0NBQUMsb0JBQUQ7QUFBZSxNQUFBLEtBQUssRUFBRUY7QUFBdEIsb0JBQ0UsZ0NBQUMsa0JBQUQsT0FERixDQURGOztBQUtBLFFBQU1HLElBQUksR0FBR0MsOEJBQVNDLE1BQVQsQ0FBZ0JILFNBQWhCLEVBQTJCSSxNQUEzQixFQUFiOztBQUNBQyxJQUFBQSxNQUFNLENBQUNKLElBQUQsQ0FBTixDQUFhSyxlQUFiO0FBQ0QsR0FSQyxDQUFGO0FBU0QsQ0FiRDs7QUFlQSxTQUFTQyxpQkFBVCxHQUF1QztBQUFBLE1BQVpDLEtBQVksdUVBQUosRUFBSTtBQUNyQyxzQkFDRSxnQ0FBQyxrQkFBRDtBQUFRLG1CQUFZO0FBQXBCLEtBQWlDQSxLQUFqQyxVQURGO0FBS0Q7O0FBTlFELGlCOztBQVFULFNBQVNFLHFCQUFULEdBQTJDO0FBQUEsTUFBWkQsS0FBWSx1RUFBSixFQUFJO0FBQ3pDLHNCQUFPLGdDQUFDLHNCQUFEO0FBQVksbUJBQVk7QUFBeEIsS0FBcUNBLEtBQXJDLEVBQVA7QUFDRDs7QUFGUUMscUI7QUFJVGhCLFFBQVEsQ0FBQyxRQUFELEVBQVcsWUFBTTtBQUN2Qk0sRUFBQUEsRUFBRSxDQUFDLG1DQUFELEVBQXNDLFlBQU07QUFDNUNNLElBQUFBLE1BQU0sQ0FBQztBQUFBLGFBQU0sb0JBQU9FLGlCQUFpQixFQUF4QixDQUFOO0FBQUEsS0FBRCxDQUFOLENBQTBDRyxHQUExQyxDQUE4Q0MsT0FBOUM7QUFDRCxHQUZDLENBQUY7QUFHQVosRUFBQUEsRUFBRSxDQUFDLDZEQUFELEVBQWdFLFlBQU07QUFDdEUsUUFBTWEsT0FBTyxHQUFHQyxJQUFJLENBQUNDLEVBQUwsRUFBaEI7O0FBQ0Esa0JBQXdCLG9CQUFPUCxpQkFBaUIsQ0FBQztBQUFFSyxNQUFBQSxPQUFPLEVBQVBBO0FBQUYsS0FBRCxDQUF4QixDQUF4QjtBQUFBLFFBQVFHLFdBQVIsV0FBUUEsV0FBUjs7QUFDQSxRQUFNQyxTQUFTLEdBQUdELFdBQVcsQ0FBQyxRQUFELENBQTdCOztBQUVBRSwwQkFBVUMsS0FBVixDQUFnQkYsU0FBaEI7O0FBQ0FYLElBQUFBLE1BQU0sQ0FBQ08sT0FBRCxDQUFOLENBQWdCTyxxQkFBaEIsQ0FBc0MsQ0FBdEM7QUFDRCxHQVBDLENBQUY7QUFRQXBCLEVBQUFBLEVBQUUsQ0FBQyxnREFBRCxFQUFtRCxZQUFNO0FBQ3pELFFBQU1hLE9BQU8sR0FBR0MsSUFBSSxDQUFDQyxFQUFMLEVBQWhCOztBQUNBLG1CQUF3QixvQkFBT1AsaUJBQWlCLENBQUM7QUFBRUssTUFBQUEsT0FBTyxFQUFQQSxPQUFGO0FBQVdRLE1BQUFBLFFBQVEsRUFBRTtBQUFyQixLQUFELENBQXhCLENBQXhCO0FBQUEsUUFBUUwsV0FBUixZQUFRQSxXQUFSOztBQUNBLFFBQU1DLFNBQVMsR0FBR0QsV0FBVyxDQUFDLFFBQUQsQ0FBN0I7QUFFQVYsSUFBQUEsTUFBTSxDQUFDO0FBQUEsYUFBTVksc0JBQVVDLEtBQVYsQ0FBZ0JGLFNBQWhCLENBQU47QUFBQSxLQUFELENBQU4sQ0FBeUNLLFlBQXpDO0FBQ0FoQixJQUFBQSxNQUFNLENBQUNPLE9BQUQsQ0FBTixDQUFnQk8scUJBQWhCLENBQXNDLENBQXRDO0FBQ0QsR0FQQyxDQUFGO0FBUUFwQixFQUFBQSxFQUFFLENBQUMsdUVBQUQsRUFBMEUsWUFBTTtBQUNoRixRQUFNYSxPQUFPLEdBQUdDLElBQUksQ0FBQ0MsRUFBTCxFQUFoQjs7QUFDQSxtQkFBd0Isb0JBQU9QLGlCQUFpQixDQUFDO0FBQUVLLE1BQUFBLE9BQU8sRUFBUEEsT0FBRjtBQUFXVSxNQUFBQSxTQUFTLEVBQUU7QUFBdEIsS0FBRCxDQUF4QixDQUF4QjtBQUFBLFFBQVFQLFdBQVIsWUFBUUEsV0FBUjs7QUFDQSxRQUFNQyxTQUFTLEdBQUdELFdBQVcsQ0FBQyxRQUFELENBQTdCO0FBRUFWLElBQUFBLE1BQU0sQ0FBQztBQUFBLGFBQU1ZLHNCQUFVQyxLQUFWLENBQWdCRixTQUFoQixDQUFOO0FBQUEsS0FBRCxDQUFOLENBQXlDSyxZQUF6QztBQUNBaEIsSUFBQUEsTUFBTSxDQUFDVyxTQUFTLENBQUNPLGFBQVYsQ0FBd0IsS0FBeEIsQ0FBRCxDQUFOLENBQXVDQyxXQUF2QztBQUNBbkIsSUFBQUEsTUFBTSxDQUFDTyxPQUFELENBQU4sQ0FBZ0JPLHFCQUFoQixDQUFzQyxDQUF0QztBQUNELEdBUkMsQ0FBRjtBQVNBcEIsRUFBQUEsRUFBRSxDQUFDLGtEQUFELEVBQXFELFlBQU07QUFDM0QsbUJBQXdCLG9CQUFPUSxpQkFBaUIsQ0FBQztBQUFFa0IsTUFBQUEsVUFBVSxFQUFFQztBQUFkLEtBQUQsQ0FBeEIsQ0FBeEI7QUFBQSxRQUFRWCxXQUFSLFlBQVFBLFdBQVI7O0FBQ0EsUUFBTUMsU0FBUyxHQUFHRCxXQUFXLENBQUMsUUFBRCxDQUE3QjtBQUVBVixJQUFBQSxNQUFNLENBQUNXLFNBQVMsQ0FBQ08sYUFBVixDQUF3QixLQUF4QixDQUFELENBQU4sQ0FBdUNJLGVBQXZDLENBQXVELFdBQXZELEVBQW9FLE1BQXBFO0FBQ0QsR0FMQyxDQUFGO0FBTUE1QixFQUFBQSxFQUFFLENBQUMsaURBQUQsRUFBb0QsWUFBTTtBQUMxRCxtQkFBd0Isb0JBQU9RLGlCQUFpQixDQUFDO0FBQUVxQixNQUFBQSxTQUFTLEVBQUVGO0FBQWIsS0FBRCxDQUF4QixDQUF4QjtBQUFBLFFBQVFYLFdBQVIsWUFBUUEsV0FBUjs7QUFDQSxRQUFNQyxTQUFTLEdBQUdELFdBQVcsQ0FBQyxRQUFELENBQTdCO0FBRUFWLElBQUFBLE1BQU0sQ0FBQ1csU0FBUyxDQUFDTyxhQUFWLENBQXdCLEtBQXhCLENBQUQsQ0FBTixDQUF1Q0ksZUFBdkMsQ0FBdUQsV0FBdkQsRUFBb0UsTUFBcEU7QUFDRCxHQUxDLENBQUY7QUFNQTVCLEVBQUFBLEVBQUUsQ0FBQyxxREFBRCxFQUF3RCxZQUFNO0FBQzlELFFBQU1hLE9BQU8sR0FBR0MsSUFBSSxDQUFDQyxFQUFMLEVBQWhCOztBQUNBLG1CQUF3QixvQkFBT1AsaUJBQWlCLENBQUM7QUFBRUssTUFBQUEsT0FBTyxFQUFQQSxPQUFGO0FBQVdnQixNQUFBQSxTQUFTLEVBQUVGO0FBQXRCLEtBQUQsQ0FBeEIsQ0FBeEI7QUFBQSxRQUFRWCxXQUFSLFlBQVFBLFdBQVI7O0FBQ0EsUUFBTUMsU0FBUyxHQUFHRCxXQUFXLENBQUMsUUFBRCxDQUE3QjtBQUVBQyxJQUFBQSxTQUFTLENBQUNhLEtBQVY7QUFDQXhCLElBQUFBLE1BQU0sQ0FBQ3lCLFFBQVEsQ0FBQ0MsYUFBVixDQUFOLENBQStCQyxPQUEvQixDQUF1Q2hCLFNBQXZDOztBQUNBQywwQkFBVWdCLFFBQVYsQ0FBbUIsU0FBbkI7O0FBQ0E1QixJQUFBQSxNQUFNLENBQUNPLE9BQUQsQ0FBTixDQUFnQk8scUJBQWhCLENBQXNDLENBQXRDOztBQUNBRiwwQkFBVWdCLFFBQVYsQ0FBbUIsU0FBbkI7O0FBQ0E1QixJQUFBQSxNQUFNLENBQUNPLE9BQUQsQ0FBTixDQUFnQk8scUJBQWhCLENBQXNDLENBQXRDO0FBQ0QsR0FYQyxDQUFGO0FBWUQsQ0FyRE8sQ0FBUjtBQXVEQTFCLFFBQVEsQ0FBQyxZQUFELEVBQWUsWUFBTTtBQUMzQk0sRUFBQUEsRUFBRSxDQUFDLDZEQUFELEVBQWdFLFlBQU07QUFDdEUsbUJBQXdCLG9CQUFPVSxxQkFBcUIsQ0FBQztBQUFFeUIsTUFBQUEsSUFBSSxFQUFFUjtBQUFSLEtBQUQsQ0FBNUIsQ0FBeEI7QUFBQSxRQUFRWCxXQUFSLFlBQVFBLFdBQVI7O0FBQ0EsUUFBTUMsU0FBUyxHQUFHRCxXQUFXLENBQUMsUUFBRCxDQUE3QjtBQUNBVixJQUFBQSxNQUFNLENBQUNXLFNBQVMsQ0FBQ08sYUFBVixDQUF3QixLQUF4QixDQUFELENBQU4sQ0FBdUNJLGVBQXZDLENBQXVELFdBQXZELEVBQW9FLE1BQXBFO0FBQ0QsR0FKQyxDQUFGO0FBS0E1QixFQUFBQSxFQUFFLENBQUMsb0RBQUQsRUFBdUQsWUFBTTtBQUM3RCxtQkFBd0Isb0JBQU9VLHFCQUFxQixDQUFDO0FBQUV5QixNQUFBQSxJQUFJLGVBQUUsZ0NBQUMsa0JBQUQ7QUFBVSxRQUFBLElBQUksRUFBRTtBQUFoQjtBQUFSLEtBQUQsQ0FBNUIsQ0FBeEI7QUFBQSxRQUFRbkIsV0FBUixZQUFRQSxXQUFSOztBQUNBLFFBQU1DLFNBQVMsR0FBR0QsV0FBVyxDQUFDLFFBQUQsQ0FBN0I7QUFDQSxRQUFNb0IsR0FBRyxHQUFHbkIsU0FBUyxDQUFDTyxhQUFWLENBQXdCLEtBQXhCLENBQVo7QUFDQWxCLElBQUFBLE1BQU0sQ0FBQytCLE1BQU0sQ0FBQ0MsZ0JBQVAsQ0FBd0JGLEdBQXhCLEVBQTZCRyxLQUE5QixDQUFOLENBQTJDTixPQUEzQyxDQUFtRCxNQUFuRDtBQUNBM0IsSUFBQUEsTUFBTSxDQUFDK0IsTUFBTSxDQUFDQyxnQkFBUCxDQUF3QkYsR0FBeEIsRUFBNkJJLE1BQTlCLENBQU4sQ0FBNENQLE9BQTVDLENBQW9ELE1BQXBEO0FBQ0QsR0FOQyxDQUFGO0FBT0QsQ0FiTyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgcmVuZGVyIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCdcbmltcG9ydCB1c2VyRXZlbnQgZnJvbSAnQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50J1xuaW1wb3J0IHJlbmRlcmVyIGZyb20gJ3JlYWN0LXRlc3QtcmVuZGVyZXInXG5pbXBvcnQgeyBMb2NrSWNvbiB9IGZyb20gJy4uLy4uL2ljb25zL2dlbmVyYXRlZC9Mb2NrSWNvbidcbmltcG9ydCB7IFRoZW1lUHJvdmlkZXIgfSBmcm9tICcuLi8uLi90aGVtZSdcbmltcG9ydCB7IGNsYXNzaWNUaGVtZSwgZGVmYXVsdFRoZW1lIH0gZnJvbSAnLi4vLi4vdGhlbWVzJ1xuaW1wb3J0IEJ1dHRvbiBmcm9tICcuLi9zcmMvQnV0dG9uJ1xuaW1wb3J0IEljb25CdXR0b24gZnJvbSAnLi4vc3JjL0ljb25CdXR0b24nXG5cbmRlc2NyaWJlLmVhY2goW1xuICBbJ2RlZmF1bHQnLCBkZWZhdWx0VGhlbWVdLFxuICBbJ2NsYXNzaWMnLCBjbGFzc2ljVGhlbWVdXG5dKSgnPEJ1dHRvbiAvPiAlICVzJywgKF8sIHRoZW1lKSA9PiB7XG4gIGl0KCdzbmFwc2hvdHMgd2l0aCB0aGUgcmVuZGVyZWQgb3V0cHV0JywgKCkgPT4ge1xuICAgIGNvbnN0IGNvbXBvbmVudCA9IChcbiAgICAgIDxUaGVtZVByb3ZpZGVyIHZhbHVlPXt0aGVtZX0+XG4gICAgICAgIDxCdXR0b24gLz5cbiAgICAgIDwvVGhlbWVQcm92aWRlcj5cbiAgICApXG4gICAgY29uc3QgdHJlZSA9IHJlbmRlcmVyLmNyZWF0ZShjb21wb25lbnQpLnRvSlNPTigpXG4gICAgZXhwZWN0KHRyZWUpLnRvTWF0Y2hTbmFwc2hvdCgpXG4gIH0pXG59KVxuXG5mdW5jdGlvbiBtYWtlQnV0dG9uRml4dHVyZShwcm9wcyA9IHt9KSB7XG4gIHJldHVybiAoXG4gICAgPEJ1dHRvbiBkYXRhLXRlc3RpZD1cImJ1dHRvblwiIHsuLi5wcm9wc30+XG4gICAgICBUZXN0XG4gICAgPC9CdXR0b24+XG4gIClcbn1cblxuZnVuY3Rpb24gbWFrZUljb25CdXR0b25GaXh0dXJlKHByb3BzID0ge30pIHtcbiAgcmV0dXJuIDxJY29uQnV0dG9uIGRhdGEtdGVzdGlkPVwiYnV0dG9uXCIgey4uLnByb3BzfSAvPlxufVxuXG5kZXNjcmliZSgnQnV0dG9uJywgKCkgPT4ge1xuICBpdCgncmVuZGVycyBjaGlsZHJlbiB3aXRob3V0IGNyYXNoaW5nJywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiByZW5kZXIobWFrZUJ1dHRvbkZpeHR1cmUoKSkpLm5vdC50b1Rocm93KClcbiAgfSlcbiAgaXQoJ2FjY2VwdHMgYW4gYG9uQ2xpY2tgIGhhbmRsZXIgdGhhdCBnZXRzIGNhbGxlZCB1cG9uIGNsaWNraW5nJywgKCkgPT4ge1xuICAgIGNvbnN0IG9uQ2xpY2sgPSBqZXN0LmZuKClcbiAgICBjb25zdCB7IGdldEJ5VGVzdElkIH0gPSByZW5kZXIobWFrZUJ1dHRvbkZpeHR1cmUoeyBvbkNsaWNrIH0pKVxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGdldEJ5VGVzdElkKCdidXR0b24nKVxuXG4gICAgdXNlckV2ZW50LmNsaWNrKGNvbnRhaW5lcilcbiAgICBleHBlY3Qob25DbGljaykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpXG4gIH0pXG4gIGl0KCdoYXMgYSBgZGlzYWJsZWRgIHByb3AgdGhhdCBkaXNhYmxlcyB0aGUgYnV0dG9uJywgKCkgPT4ge1xuICAgIGNvbnN0IG9uQ2xpY2sgPSBqZXN0LmZuKClcbiAgICBjb25zdCB7IGdldEJ5VGVzdElkIH0gPSByZW5kZXIobWFrZUJ1dHRvbkZpeHR1cmUoeyBvbkNsaWNrLCBkaXNhYmxlZDogdHJ1ZSB9KSlcbiAgICBjb25zdCBjb250YWluZXIgPSBnZXRCeVRlc3RJZCgnYnV0dG9uJylcblxuICAgIGV4cGVjdCgoKSA9PiB1c2VyRXZlbnQuY2xpY2soY29udGFpbmVyKSkudG9UaHJvd0Vycm9yKClcbiAgICBleHBlY3Qob25DbGljaykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDApXG4gIH0pXG4gIGl0KCdoYXMgYSBgaXNMb2FkaW5nYCBwcm9wIHRoYXQgcmVuZGVycyBhIHNwaW5uZXIgYW5kIGRpc2FibGVzIHRoZSBidXR0b24nLCAoKSA9PiB7XG4gICAgY29uc3Qgb25DbGljayA9IGplc3QuZm4oKVxuICAgIGNvbnN0IHsgZ2V0QnlUZXN0SWQgfSA9IHJlbmRlcihtYWtlQnV0dG9uRml4dHVyZSh7IG9uQ2xpY2ssIGlzTG9hZGluZzogdHJ1ZSB9KSlcbiAgICBjb25zdCBjb250YWluZXIgPSBnZXRCeVRlc3RJZCgnYnV0dG9uJylcblxuICAgIGV4cGVjdCgoKSA9PiB1c2VyRXZlbnQuY2xpY2soY29udGFpbmVyKSkudG9UaHJvd0Vycm9yKClcbiAgICBleHBlY3QoY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpKS50b0JlVmlzaWJsZSgpXG4gICAgZXhwZWN0KG9uQ2xpY2spLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKVxuICB9KVxuICBpdCgncmVuZGVycyBhbiBpY29uIGluIGVpdGhlciB0aGUgYGljb25CZWZvcmVgIHByb3BzJywgKCkgPT4ge1xuICAgIGNvbnN0IHsgZ2V0QnlUZXN0SWQgfSA9IHJlbmRlcihtYWtlQnV0dG9uRml4dHVyZSh7IGljb25CZWZvcmU6IExvY2tJY29uIH0pKVxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGdldEJ5VGVzdElkKCdidXR0b24nKVxuXG4gICAgZXhwZWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzdmcnKSkudG9IYXZlQXR0cmlidXRlKCdkYXRhLWljb24nLCAnbG9jaycpXG4gIH0pXG4gIGl0KCdyZW5kZXJzIGFuIGljb24gaW4gZWl0aGVyIHRoZSBgaWNvbkFmdGVyYCBwcm9wcycsICgpID0+IHtcbiAgICBjb25zdCB7IGdldEJ5VGVzdElkIH0gPSByZW5kZXIobWFrZUJ1dHRvbkZpeHR1cmUoeyBpY29uQWZ0ZXI6IExvY2tJY29uIH0pKVxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGdldEJ5VGVzdElkKCdidXR0b24nKVxuXG4gICAgZXhwZWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzdmcnKSkudG9IYXZlQXR0cmlidXRlKCdkYXRhLWljb24nLCAnbG9jaycpXG4gIH0pXG4gIGl0KCdwcm9wZXJseSBoYW5kbGVzIGtleWJvYXJkIGV2ZW50cyB0byBzaW11bGF0ZSBjbGlja3MnLCAoKSA9PiB7XG4gICAgY29uc3Qgb25DbGljayA9IGplc3QuZm4oKVxuICAgIGNvbnN0IHsgZ2V0QnlUZXN0SWQgfSA9IHJlbmRlcihtYWtlQnV0dG9uRml4dHVyZSh7IG9uQ2xpY2ssIGljb25BZnRlcjogTG9ja0ljb24gfSkpXG4gICAgY29uc3QgY29udGFpbmVyID0gZ2V0QnlUZXN0SWQoJ2J1dHRvbicpXG5cbiAgICBjb250YWluZXIuZm9jdXMoKVxuICAgIGV4cGVjdChkb2N1bWVudC5hY3RpdmVFbGVtZW50KS50b0VxdWFsKGNvbnRhaW5lcilcbiAgICB1c2VyRXZlbnQua2V5Ym9hcmQoJ3tlbnRlcn0nKVxuICAgIGV4cGVjdChvbkNsaWNrKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSlcbiAgICB1c2VyRXZlbnQua2V5Ym9hcmQoJ3tzcGFjZX0nKVxuICAgIGV4cGVjdChvbkNsaWNrKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMilcbiAgfSlcbn0pXG5cbmRlc2NyaWJlKCdJY29uQnV0dG9uJywgKCkgPT4ge1xuICBpdCgnUGFzc2VzIHRocm91Z2ggYW4gaWNvbiB3aGVuIHBhc3NlcyBhcyBhIGNvbXBvbmVudCByZWZlcmVuY2UnLCAoKSA9PiB7XG4gICAgY29uc3QgeyBnZXRCeVRlc3RJZCB9ID0gcmVuZGVyKG1ha2VJY29uQnV0dG9uRml4dHVyZSh7IGljb246IExvY2tJY29uIH0pKVxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGdldEJ5VGVzdElkKCdidXR0b24nKVxuICAgIGV4cGVjdChjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3ZnJykpLnRvSGF2ZUF0dHJpYnV0ZSgnZGF0YS1pY29uJywgJ2xvY2snKVxuICB9KVxuICBpdCgnUGFzc2VzIHRocm91Z2ggYW4gaW5zdGFudGlhdGVkIGNvbXBvbmVudCBhcyBgaWNvbmAnLCAoKSA9PiB7XG4gICAgY29uc3QgeyBnZXRCeVRlc3RJZCB9ID0gcmVuZGVyKG1ha2VJY29uQnV0dG9uRml4dHVyZSh7IGljb246IDxMb2NrSWNvbiBzaXplPXsyNH0gLz4gfSkpXG4gICAgY29uc3QgY29udGFpbmVyID0gZ2V0QnlUZXN0SWQoJ2J1dHRvbicpXG4gICAgY29uc3Qgc3ZnID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpXG4gICAgZXhwZWN0KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHN2Zykud2lkdGgpLnRvRXF1YWwoJzI0cHgnKVxuICAgIGV4cGVjdCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShzdmcpLmhlaWdodCkudG9FcXVhbCgnMjRweCcpXG4gIH0pXG59KVxuIl19